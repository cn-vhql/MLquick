# 特征配置功能使用指南

## 📋 功能概述

特征配置功能允许用户从特征库中选择特定特征用于模型训练，提供了灵活的特征管理能力。

## 🎯 主要功能

### 1. 特征库管理
- **33个预定义特征**：包括基础价格数据、技术指标、成交量指标等
- **7个特征类别**：基础数据、价格变化、趋势指标、动量指标、波动率指标、成交量指标、价格特征
- **智能分类**：按功能和用途对特征进行分类管理

### 2. 预设配置
- **基础配置**：包含最核心的10个特征（OHLCV + MA5/10/20 + RSI + MACD）
- **技术分析**：包含21个技术分析相关特征
- **全特征**：启用所有33个特征
- **仅价格**：仅包含价格相关特征
- **仅技术指标**：仅包含技术指标类特征

### 3. 自定义选择
- **按类别选择**：可按特征类别批量启用/禁用
- **单个特征控制**：精确控制每个特征的启用状态
- **实时预览**：显示当前启用的特征列表和统计信息

### 4. 配置管理
- **保存配置**：将当前特征选择保存到本地文件
- **加载配置**：从文件恢复之前的特征配置
- **批量操作**：一键启用/禁用所有特征

## 🚀 使用步骤

### 步骤1：访问特征配置
1. 启动应用后，点击 **"⚙️ 特征配置"** 标签页
2. 查看当前特征库统计信息（总特征数、已启用数、启用率等）

### 步骤2：选择特征（任选一种方式）

#### 方式A：使用预设配置
- 点击预设配置按钮（如"基础配置"、"技术分析"等）
- 系统会自动应用该预设的特征选择

#### 方式B：自定义选择
1. **基础数据和价格特征**（左侧栏）
   - 点击类别展开具体特征
   - 勾选/取消勾选特征复选框

2. **技术指标和成交量特征**（右侧栏）
   - 点击类别展开具体特征
   - 勾选/取消勾选特征复选框

### 步骤3：保存配置（可选）
- 点击 **"保存当前配置"** 按钮保存特征选择
- 配置会保存到 `feature_configs.json` 文件

### 步骤4：进行模型训练
1. 切换到 **"🤖 模型训练与预测"** 标签页
2. 配置训练参数（历史天数、预测天数等）
3. 点击 **"🚀 开始训练模型"**
4. 系统会自动使用当前特征配置进行训练

## 📊 特征类别详解

### 基础数据（5个特征）
- **open, high, low, close**: OHLC基础价格数据
- **volume**: 成交量数据

### 价格变化（3个特征）
- **price_change**: 单日价格变化率
- **price_change_3d**: 3日价格变化率
- **price_change_5d**: 5日价格变化率

### 趋势指标（3个特征）
- **MA5**: 5日移动平均线
- **MA10**: 10日移动平均线
- **MA20**: 20日移动平均线

### 动量指标（12个特征）
- **RSI**: 相对强弱指数
- **MACD**: MACD指标
- **Signal**: MACD信号线
- **Histogram**: MACD柱状图
- **Williams_R**: 威廉指标
- **K_value, D_value, J_value**: KDJ随机指标
- **momentum**: 动量指标
- **price_acceleration**: 价格加速指标
- **CCI**: 商品通道指数

### 波动率指标（3个特征）
- **BB_upper, BB_middle, BB_lower**: 布林带上中下轨
- **ATR**: 平均真实波幅

### 成交量指标（4个特征）
- **volume_MA5, volume_MA10**: 成交量移动平均
- **volume_ratio**: 成交量比率
- **OBV**: 能量潮指标

### 价格特征（1个特征）
- **price_position**: 价格位置（当前价格在当日高低价区间的位置）
- **volatility**: 波动率
- **VWAP**: 成交量加权平均价

## 💡 使用建议

### 初学者
- 推荐使用 **"基础配置"** 开始
- 包含最核心的特征，避免过拟合

### 进阶用户
- 可以尝试 **"技术分析"** 预设
- 或根据需要自定义选择特征组合

### 高级用户
- 可以创建自定义特征组合
- 通过对比不同配置的模型性能来优化选择

## ⚠️ 注意事项

1. **特征数量**：
   - 选择过多特征可能导致过拟合
   - 选择过少特征可能导致信息不足
   - 建议从5-15个特征开始

2. **数据质量**：
   - 确保选择的特征在数据中实际存在
   - 某些技术指标需要足够的历史数据才能计算

3. **配置持久化**：
   - 配置文件保存为 `feature_configs.json`
   - 可以备份此文件以保存特征配置

4. **性能考虑**：
   - 特征越多，训练时间越长
   - 某些特征可能对特定品种不适用

## 🔧 技术实现

### 文件结构
```
├── feature_library.py      # 特征库管理核心代码
├── feature_configs.json   # 特征配置文件（自动生成）
└── streamlit_app.py       # 特征配置界面
```

### 核心类和函数
- **FeatureLibrary**: 特征库管理类
- **FeatureConfig**: 特征配置数据类
- **create_features_targets()**: 支持选择性特征的特征工程函数
- **train_complete_workflow()**: 支持选择性特征的模型训练流程

### 数据流程
1. 用户在界面选择特征 →
2. 特征库保存配置 →
3. 模型训练时读取配置 →
4. 特征工程只使用选择的特征 →
5. 模型基于选择的特征进行训练

## 🎉 总结

特征配置功能提供了：
- ✅ 灵活的特征选择能力
- ✅ 预设配置快速开始
- ✅ 自定义配置精确控制
- ✅ 配置保存和恢复
- ✅ 实时统计和预览
- ✅ 与现有训练流程无缝集成

通过这个功能，你可以更精确地控制模型训练使用的特征，从而提高模型的准确性和泛化能力！